---
id: 001
title: Create Phase IV Constitution
stage: constitution
date: 2026-02-23
surface: agent
model: claude-sonnet-4-6
feature: none
branch: master
user: user
command: /sp.constitution
labels: ["constitution", "phase-iv", "kubernetes", "governance"]
links:
  spec: null
  ticket: null
  adr: null
  pr: null
files:
  - .specify/memory/constitution.md
tests:
  - N/A
---

## Prompt

/sp.constitution
Project: Full-Stack Todo Web Application with AI Chatbot and Local Kubernetes Deployment (Phases I, II, III, IV)
Core principles:

Strict adherence to the exact requirements, architecture diagrams, and technology stack provided in each phase
Agentic development only: every line of code, Docker command, Helm chart, or Kubernetes manifest must be generated via the Spec → Plan → Tasks → Claude Code workflow (no manual coding or commands)
Stateless, scalable, production-ready design (extended to Kubernetes in Phase IV)
Security, input validation, and proper error handling at every layer
Clean, readable, well-documented code with clear separation of concerns
Full reproducibility: everything must be configurable via environment variables and documented in README
For Phase IV: Use standard Docker CLI commands generated by Claude Code (no Docker AI Gordon, due to old Docker Desktop); leverage kubectl-ai and Kagent for AI-assisted ops, but all deployments via Helm charts generated agentically

Key standards:

Follow the exact database models, API contracts, MCP tool signatures, and agent behaviors from Phase III, now containerized and deployed to Minikube
Use official SDKs and tools only (Docker CLI, Minikube, Helm, kubectl-ai, Kagent)
All state persisted in Neon PostgreSQL (or local equivalent for dev); no in-memory state
Containerize frontend (ChatKit) and backend (FastAPI + MCP + Agents) using Dockerfiles generated via Claude Code
Helm charts for deployment: Generate via kubectl-ai/Kagent or Claude Code, deploy to Minikube
AI DevOps: Prompts must include examples like 'kubectl-ai "deploy the todo frontend with 2 replicas"' for assistance, but final manifests/charts via spec-driven workflow
Frontend/Backend from Phase III must be containerized separately
Research integration: Use blueprints for spec-driven infrastructure (e.g., Spec-Driven Cloud-Native Architecture with Claude Code)

Constraints:

Phase IV builds on Phase III: Containerize and deploy the existing Todo Chatbot (no changes to app code)
No Docker Gordon: Use standard 'docker build', 'docker push' (to local Minikube registry if needed), generated by Claude Code
Server/cluster must remain stateless and local (Minikube only; no cloud)
No hard-coded credentials; use secrets in Helm/Kubernetes
Domain allowlist from Phase III carries over if applicable
Word count/scope: Deliver exactly the features listed (containerization, Helm charts, Minikube deploy); no extras

Success criteria:

Working Docker images for frontend and backend, built via generated Dockerfiles
Helm charts deploy the app to Minikube successfully (pods running, services accessible)
kubectl-ai and Kagent used in workflow to generate/optimize deployments (e.g., scale, health checks)
Chatbot accessible via Minikube (e.g., minikube service)
Full persistence: Conversations/tasks survive pod restarts
Zero manual commands: All Docker/K8s ops generated through spec-kit
Deliverables: Updated GitHub repo with /docker, /helm folders; README with Minikube setup, kubectl-ai/Kagent usage
Passes local tests: Deploy, interact with chatbot, undeploy cleanly

Not allowed in any phase:

Deviating from the listed technology stack
Using Docker Gordon or any unavailable features
Manual Docker/K8s commands; must be agent-generated
Deploying to cloud (local Minikube only)
Adding features not listed in Phase IV (e.g., no advanced AIOps unless spec'd)

Phase-specific guidance (add to existing from Phases I-III):

Phase IV focuses on containerization (Dockerfiles for frontend/backend/MCP), Helm chart generation (using kubectl-ai/Kagent for assistance), and Minikube deployment
Integrate research notes: Use spec-driven blueprints for infra automation (e.g., prompt Claude Code with specs for Helm/YAML)
Agents from previous phases (e.g., Backend-Implementer) can assist in generating Docker/Helm code
For old Docker Desktop: Prompts must specify 'generate standard Docker CLI commands without AI agents'

## Response snapshot

Created constitution v1.0.0 at `.specify/memory/constitution.md` with 7 core principles:
I. Strict Requirements Adherence, II. Agentic Development Only, III. Stateless Scalable Production-Ready Design, IV. Security at Every Layer, V. Clean Code and Separation of Concerns, VI. Full Reproducibility, VII. Spec-Driven Infrastructure. Plus 3 additional sections: Key Standards & Toolchain, Constraints & Guardrails, Success Criteria & Deliverables. Governance rules with semantic versioning. All 3 dependent templates (plan, spec, tasks) verified compatible. Sync Impact Report embedded.

## Outcome

- Impact: First ratification of project constitution governing Phases I-IV development
- Tests: N/A (governance document)
- Files: .specify/memory/constitution.md (created)
- Next prompts: /sp.specify for Phase IV feature specification
- Reflection: Template had 6 principle slots; expanded to 7 to match user input. All placeholders resolved. No template updates needed.

## Evaluation notes (flywheel)

- Failure modes observed: None
- Graders run and results (PASS/FAIL): Manual validation PASS — no unresolved placeholders, version matches report, dates ISO format, principles declarative and testable
- Prompt variant (if applicable): N/A
- Next experiment (smallest change to try): N/A
